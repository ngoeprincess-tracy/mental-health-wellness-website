<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard â€” MINDWELL</title>
  <style>
    :root{--bg:#f3fff7;--card:#fff;--accent:#2f9e44;--accent-600:#227a35;--muted:#3f6b56}
    body{font-family:Inter,Segoe UI,Roboto,system-ui,Arial; margin:0; background:var(--bg); color:#111;}
    .container{max-width:900px;margin:32px auto;padding:20px;}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;}
    h1{font-size:1.25rem;margin:0;}
    .date{color:var(--muted); font-size:0.95rem;}
    .card{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(13,38,76,0.06);margin-bottom:16px;}
    .mood-row{display:flex;align-items:center;gap:18px;}
    .mood-display{font-size:48px;width:120px;height:120px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#f4f7fb);flex-direction:column}
    .mood-label{font-weight:600;margin-top:6px}
    .actions{display:flex;gap:12px;flex-wrap:wrap;}
    .btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    .btn.secondary{background:#eef4fb;color:var(--accent);border:1px solid #dbe9fb}
    .btn.ghost{background:transparent;color:var(--accent);border:1px dashed #cfe3fa}
    .mood-options{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;}
    .mood-option{padding:8px 10px;border-radius:10px;background:#fff;border:1px solid #eee;cursor:pointer;display:flex;align-items:center;gap:8px}
    footer{margin-top:18px;color:var(--muted);font-size:0.9rem;text-align:center}
    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(6,12,26,0.5);display:none;align-items:center;justify-content:center}
    .modal{background:#fff;padding:18px;border-radius:12px;max-width:460px;width:92%}
    .modal h2{margin:0 0 8px 0}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    /* Crisis support footer (shared) */
    .crisis-footer{
      position:fixed;
      left:16px; right:16px; bottom:16px;
      background:linear-gradient(90deg,#f0fff4,#e6fff0);
      border:1px solid #b7f3c7;
      color:var(--accent-600);
      padding:12px 14px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(15,80,40,0.06);
      display:flex;
      gap:12px;
      align-items:center;
      z-index:9999;
      font-size:0.95rem;
    }
    .crisis-footer a{ color:var(--accent-600); font-weight:600; text-decoration:underline; }
    .crisis-close { margin-left:auto; background:transparent; border:0; font-size:18px; line-height:1; cursor:pointer; color:var(--accent-600); }
    @media (max-width:520px){ .crisis-footer{left:10px;right:10px;bottom:10px;font-size:0.9rem} }
  </style>
</head>
<body>
  <div class="container">
    <!-- Site header / global nav -->
    <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px">
      <div>
        <a href="index.html" style="text-decoration:none;color:inherit"><strong>MINDWELL</strong></a>
        <div style="color:var(--muted);font-size:0.9rem">Tools & resources</div>
      </div>
      <nav aria-label="Primary">
        <a class="btn secondary" href="dashboard.html">Dashboard</a>
        <a class="btn secondary" href="chat.html">Chat</a>
        <a class="btn secondary" href="exercises.html">Exercises</a>
        <a class="btn ghost" href="articles.html">Articles</a>
      </nav>
    </header>

    <header>
      <div>
        <h1>Mental Health Dashboard</h1>
        <div class="date" id="todayDate"></div>
      </div>
      <div class="actions" role="navigation" aria-label="Quick actions">
        <button class="btn" id="btnCheckMood">Check Mood</button>
        <button class="btn secondary" id="btnChat">Chat</button>
        <button class="btn secondary" id="btnExercises">Exercises</button>
        <button class="btn ghost" id="btnArticles">Read Articles</button>
      </div>
    </header>

    <section class="card" aria-labelledby="mood-heading">
      <h2 id="mood-heading" style="margin-top:0">Today's mood</h2>
      <div class="mood-row">
        <div class="mood-display" id="moodDisplay" aria-live="polite" title="Today's saved mood">
          <div id="moodEmoji" style="font-size:44px">ðŸ™‚</div>
          <div class="mood-label" id="moodText">Feeling fine</div>
        </div>
        <div style="flex:1">
          <p style="margin:0 0 8px 0; color:var(--muted)">
            Track how you're feeling today. Use "Check Mood" to pick or update your mood. Saved locally on this device.
          </p>

          <div style="margin-top:6px">
            <strong>Quick mood options:</strong>
            <div class="mood-options" id="quickOptions" aria-hidden="false">
              <button data-emoji="ðŸ˜„" data-text="Very happy" class="mood-option" aria-label="Very happy">ðŸ˜„ Very happy</button>
              <button data-emoji="ðŸ™‚" data-text="Feeling fine" class="mood-option" aria-label="Feeling fine">ðŸ™‚ Fine</button>
              <button data-emoji="ðŸ˜Ÿ" data-text="A bit down" class="mood-option" aria-label="A bit down">ðŸ˜Ÿ Down</button>
              <button data-emoji="ðŸ˜°" data-text="Anxious" class="mood-option" aria-label="Anxious">ðŸ˜° Anxious</button>
              <button data-emoji="ðŸ˜´" data-text="Tired" class="mood-option" aria-label="Tired">ðŸ˜´ Tired</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="card" aria-label="Resources">
      <h3 style="margin-top:0">Resources</h3>
      <p style="color:var(--muted);margin:6px 0 12px 0">Try short exercises, read articles, or chat if you need immediate support.</p>
      <div class="actions">
        <button class="btn secondary" id="btnDoExercise">Start a breathing exercise</button>
        <button class="btn secondary" id="btnReadArticle">Browse articles</button>
        <button class="btn" id="btnStartChat">Open chat</button>
      </div>
    </section>

    <footer>
      Saved locally. No account required. <span id="savedMsg"></span>
    </footer>
  </div>

  <!-- Modal: Mood picker -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <h2>How are you feeling right now?</h2>
      <div class="row" id="modalOptions">
        <button data-emoji="ðŸ˜„" data-text="Very happy" class="mood-option">ðŸ˜„ Very happy</button>
        <button data-emoji="ðŸ™‚" data-text="Feeling fine" class="mood-option">ðŸ™‚ Fine</button>
        <button data-emoji="ðŸ˜Ÿ" data-text="A bit down" class="mood-option">ðŸ˜Ÿ Down</button>
        <button data-emoji="ðŸ˜°" data-text="Anxious" class="mood-option">ðŸ˜° Anxious</button>
        <button data-emoji="ðŸ˜´" data-text="Tired" class="mood-option">ðŸ˜´ Tired</button>
        <button data-emoji="ðŸ˜µ" data-text="Overwhelmed" class="mood-option">ðŸ˜µ Overwhelmed</button>
      </div>
      <div style="margin-top:12px;text-align:right">
        <button class="btn secondary" id="closeModal">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Crisis support footer (persistent across pages) -->
  <div class="crisis-footer" role="contentinfo" aria-live="polite">
    <div>
      If you are in immediate danger or thinking about harming yourself, call local emergency services now.
      In Cameroon dial <strong>119</strong>.
    </div>
    <button id="crisisClose" class="crisis-close" aria-label="Dismiss crisis support">âœ•</button>
  </div>

  <script src="motiv.js" defer></script>
  <script>
    // Utils
    const todayKey = (() => {
      const d = new Date();
      return 'mood_' + d.toISOString().slice(0,10); // key per day
    })();

    const formatDate = (d) => d.toLocaleDateString(undefined, {weekday:'long', month:'short', day:'numeric'});

    // DOM
    const todayDate = document.getElementById('todayDate');
    const moodEmoji = document.getElementById('moodEmoji');
    const moodText = document.getElementById('moodText');
    const savedMsg = document.getElementById('savedMsg');
    const backdrop = document.getElementById('modalBackdrop');

    todayDate.textContent = formatDate(new Date());

    function loadMood() {
      try {
        const raw = localStorage.getItem(todayKey);
        if (!raw) return;
        const data = JSON.parse(raw);
        setMoodDisplay(data.emoji, data.text, false);
        savedMsg.textContent = `Last saved: ${new Date(data.ts).toLocaleTimeString()}`;
      } catch(e) { console.warn('loadMood error', e); }
    }

    function saveMood(emoji, text) {
      const data = { emoji, text, ts: Date.now() };
      try {
        localStorage.setItem(todayKey, JSON.stringify(data));
        savedMsg.textContent = `Last saved: ${new Date(data.ts).toLocaleTimeString()}`;
      } catch(e) {
        console.warn('saveMood error', e);
      }
    }

    function setMoodDisplay(emoji, text, persist=true) {
      moodEmoji.textContent = emoji;
      moodText.textContent = text;
      if (persist) saveMood(emoji, text);
    }

    // Quick options handlers
    document.querySelectorAll('.mood-option').forEach(btn => {
      btn.addEventListener('click', (ev) => {
        const b = ev.currentTarget;
        const emoji = b.dataset.emoji;
        const text = b.dataset.text;
        setMoodDisplay(emoji, text, true);
        closeModal();
      });
    });

    // Buttons
    document.getElementById('btnCheckMood').addEventListener('click', openModal);
    document.getElementById('closeModal').addEventListener('click', closeModal);
    document.getElementById('btnChat').addEventListener('click', () => { window.location.href = 'chat.html'; });
    document.getElementById('btnStartChat').addEventListener('click', () => { window.location.href = 'chat.html'; });
    document.getElementById('btnExercises').addEventListener('click', () => { window.location.href = 'exercises.html'; });
    document.getElementById('btnDoExercise').addEventListener('click', startBreathingExercise);
    document.getElementById('btnArticles').addEventListener('click', () => { window.location.href = 'articles.html'; });
    document.getElementById('btnReadArticle').addEventListener('click', () => { window.location.href = 'articles.html'; });

    function openModal(){
      backdrop.style.display = 'flex';
      backdrop.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      backdrop.style.display = 'none';
      backdrop.setAttribute('aria-hidden','true');
    }

    // Simple breathing exercise demo
    function startBreathingExercise(){
      const duration = 20; // seconds demo
      let seconds = duration;
      const prevText = moodText.textContent;
      const prevEmoji = moodEmoji.textContent;
      const interval = setInterval(() => {
        if (seconds <= 0){
          clearInterval(interval);
          setMoodDisplay(prevEmoji, prevText, false);
          alert('Exercise finished. Hope you feel a little better.');
          return;
        }
        moodEmoji.textContent = 'ðŸŒ¬ï¸';
        moodText.textContent = 'Breathing... ' + seconds + 's';
        seconds--;
      }, 1000);
    }

    // Initialize
    loadMood();

    // keyboard: Esc closes modal
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // Crisis footer behavior (hide for 24h when dismissed)
    (function(){
      const KEY = 'mh_crisis_hidden_until';
      const el = document.querySelector('.crisis-footer');
      if (!el) return;
      const close = document.getElementById('crisisClose');
      const hiddenUntil = Number(localStorage.getItem(KEY) || 0);
      if (hiddenUntil > Date.now()) el.style.display = 'none';
      close.addEventListener('click', () => {
        el.style.display = 'none';
        localStorage.setItem(KEY, String(Date.now() + 24*60*60*1000));
      });
    })();
   </script>
 </body>
 </html>